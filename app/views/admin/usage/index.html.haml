.container

  %h1
    %i.fa.fa-area-chart
    Usage Data

  = form_tag(admin_usage_index_path, 'role' => 'form') do
    .form-group
      %label Organization
      = select_tag :organization, options_for_select(@organizations, selected: params[:organization]), class: 'form-control'
    .form-group
      %label From Date
      = datetime_select :from, nil, default: @from_date, class: 'form-control'
    .form-group
      %label To Date
      = datetime_select :to, nil, default: @to_date, class: 'form-control'

    = submit_tag 'Generate â†’', class: 'btn btn-primary'


  - if @instance_results
    %h2 Instance Usage
    - @instance_results.each do |tenant, instances|
      %h3= tenant
      - if instances.values.any?
        %table.table.table-hover
          %thead
            %tr
              %th Name
              %th Uptime (hours)
              %th Number of Cores
              %th RAM (GB)
              %th Root Disk (GB)
              %th Image ID
          %tbody
            - instances.each do |_, results|
              %tr
                %td= results[:name]
                %td= number_with_delimiter((results[:billable_seconds] / 360.0).round(2), :delimiter => ',')
                %td= results[:flavor][:vcpus_count]
                %td= (results[:flavor][:ram_mb] / 1024.0).round(2)
                %td= results[:flavor][:root_disk_gb]
                %td= results[:image_id]
      - else
        No instance data for this period.

  - if @volume_results
    %h2 Volume Usage
    - @volume_results.each do |tenant, volumes|
      %h3= tenant
      - if volumes.values.any?
        %table.table.table-hover
          %thead
            %tr
              %th Name
              %th Terabyte/Hours
          %tbody
            - volumes.each do |_, results|
              %tr
                %td= results[:name]
                %td= number_with_delimiter(((results[:gigabyte_seconds] / 360.0) / 1024.0).round(2), :delimiter => ',')
      - else
        No volume data for this period.
